# ============================================================================
# Logging Plugin Manifest
# ============================================================================
#
# This manifest describes the logging plugin and its requirements.
#
# ============================================================================

name: logging-plugin
version: 1.0.0
description: Request and response logging plugin with sensitive data masking
author: Rockstar Framework Team

# Framework compatibility
framework:
  version: ">=1.0.0"

# Plugin dependencies
dependencies: []

# Required permissions
permissions:
  database: false
  cache: false
  router: true      # For registering logging middleware
  config: true      # For accessing configuration
  filesystem: true  # For writing log files
  network: false
  exec: false

# Configuration schema
config:
  log_requests:
    type: bool
    default: true
    description: Enable request logging
  
  log_responses:
    type: bool
    default: true
    description: Enable response logging
  
  log_headers:
    type: bool
    default: true
    description: Include headers in logs
  
  log_body:
    type: bool
    default: false
    description: Include request/response body in logs
  
  log_query_params:
    type: bool
    default: true
    description: Include query parameters in logs
  
  request_log_level:
    type: string
    default: "info"
    description: Log level for requests
  
  error_log_level:
    type: string
    default: "error"
    description: Log level for errors
  
  output_format:
    type: string
    default: "json"
    description: Log output format (json, text, or structured)
  
  include_timestamp:
    type: bool
    default: true
    description: Include timestamp in logs
  
  include_request_id:
    type: bool
    default: true
    description: Include request ID in logs
  
  async_logging:
    type: bool
    default: true
    description: Enable asynchronous logging
  
  buffer_size:
    type: int
    default: 1000
    description: Async logging buffer size
  
  excluded_paths:
    type: array
    items: string
    default:
      - "/health"
      - "/metrics"
    description: Paths to exclude from logging
  
  excluded_methods:
    type: array
    items: string
    default: []
    description: HTTP methods to exclude from logging
  
  mask_headers:
    type: array
    items: string
    default:
      - "Authorization"
      - "Cookie"
      - "X-API-Key"
    description: Headers to mask in logs
  
  mask_query_params:
    type: array
    items: string
    default:
      - "password"
      - "token"
      - "api_key"
    description: Query parameters to mask in logs

# Hook registrations
hooks:
  - type: pre_request
    priority: 50
  - type: post_request
    priority: 50
  - type: error
    priority: 50

# Event subscriptions and publications
events:
  publishes:
    - log.request
    - log.response
    - log.error
  subscribes:
    - auth.login
    - auth.logout

# Exported services
exports:
  - name: LoggingService
    description: Request and response logging service
