# ============================================================================
# Authentication Plugin Manifest
# ============================================================================
#
# This manifest describes the authentication plugin and its requirements.
#
# ============================================================================

name: auth-plugin
version: 1.0.0
description: Authentication and authorization plugin with JWT and session support
author: Rockstar Framework Team

# Framework compatibility
framework:
  version: ">=1.0.0"

# Plugin dependencies
dependencies: []

# Required permissions
permissions:
  database: true    # For storing users, sessions, and tokens
  cache: true       # For caching authentication data
  router: true      # For registering authentication middleware
  config: true      # For accessing configuration
  filesystem: false
  network: false
  exec: false

# Configuration schema
config:
  jwt_secret:
    type: string
    required: true
    description: Secret key for JWT token signing
  
  token_duration:
    type: duration
    default: "2h"
    description: JWT token validity duration
  
  require_auth:
    type: bool
    default: true
    description: Whether authentication is required by default
  
  excluded_paths:
    type: array
    items: string
    default:
      - "/health"
      - "/metrics"
    description: Paths that don't require authentication
  
  session_cookie_name:
    type: string
    default: "auth_session"
    description: Name of the session cookie
  
  session_duration:
    type: duration
    default: "24h"
    description: Session validity duration
  
  enable_csrf:
    type: bool
    default: true
    description: Enable CSRF protection
  
  enable_rate_limiting:
    type: bool
    default: true
    description: Enable rate limiting for login attempts
  
  max_login_attempts:
    type: int
    default: 5
    description: Maximum login attempts before lockout
  
  lockout_duration:
    type: duration
    default: "15m"
    description: Account lockout duration after max attempts

# Hook registrations
hooks:
  - type: pre_request
    priority: 200
  - type: post_request
    priority: 200

# Event subscriptions and publications
events:
  publishes:
    - auth.login
    - auth.logout
    - auth.token_created
    - auth.token_expired
    - auth.session_created
    - auth.session_expired
  subscribes: []

# Exported services
exports:
  - name: AuthService
    description: Authentication and authorization service
